# BaumanEDUcnnFrame

BaumanEDUcnnFrame — это написанный с нуля на C++17 проект, демонстрирующий концепции глубокого обучения. Он включает в себя как библиотеку для построения сверточных нейронных сетей (CNN), так и агента для обучения с подкреплением (Reinforcement Learning) для игры в "Змейку".

## Возможности

- **Библиотека CNN**:
  - **Тензорная библиотека**: базовая структура данных `Tensor` для многомерных массивов.
  - **Модульная архитектура слоев**: `Conv2D`, `MaxPooling2D`, `Dense`, `Flatten`, `ReLU`, `Softmax` и др.
  - **Модель `Sequential`**: простой способ создания нейросетей путем последовательного добавления слоев.
  - **Оптимизаторы**: `Adam`, `SGD`.
  - **Функции потерь**: `CrossEntropyLoss`, `MeanSquaredError`.
  - **Тренировочный цикл**: класс `Trainer` для удобного обучения моделей на наборе данных MNIST.

- **Агент для "Змейки" (Reinforcement Learning)**:
  - **DQN Агент**: реализация алгоритма Deep Q-Network (`DQNAgent`).
  - **Среда "Змейка"**: классическая игра "Змейка" (`snake.hpp`), адаптированная для обучения.
  - **Обучение и Визуализация**: возможность как обучать агента, так и наблюдать за его игрой.

## Структура проекта

- `main.cpp`: Главный файл, содержащий меню для выбора режима работы (обучение/тестирование MNIST, обучение/визуализация "Змейки").
- `DQNAgent.h`, `DQNAgent.cpp`: Реализация DQN-агента для обучения с подкреплением.
- `snake.hpp`: Реализация игровой среды "Змейка".
- `*.h`: Другие заголовочные файлы, определяющие слои, оптимизаторы и утилиты для CNN.
- `mnist/`: Каталог для хранения набора данных MNIST.
- `CMakeLists.txt`: Скрипт для сборки единого приложения `cnn_suite`.

## Системные требования

- C++17-совместимый компилятор (GCC, Clang, MSVC)
- CMake (версия 3.10 или выше)
- Git
- Библиотека `ncurses` для визуализации "Змейки".

## Начало работы

### 1. Клонирование репозитория

```bash
git clone <URL-репозитория>
cd BaumanEDUcnnFrame
```

### 2. Загрузка набора данных MNIST

Для обучения и тестирования модели MNIST требуется соответствующий набор данных.

1. Создайте каталог `mnist`:
   ```bash
   mkdir mnist
   ```
2. Загрузите файлы набора данных MNIST и поместите их в этот каталог:
   - `train-images-idx3-ubyte`
   - `train-labels-idx1-ubyte`
   - `t10k-images-idx3-ubyte`
   - `t10k-labels-idx1-ubyte`

   Вы можете скачать их с официального сайта [Yann LeCun's website](http://yann.lecun.com/exdb/mnist/).

### 3. Сборка проекта

Используйте CMake для сборки единого приложения `cnn_suite`.

```bash
# Создание каталога для сборки и конфигурация
cmake -B build

# Сборка проекта
cmake --build build
```

### 4. Запуск приложения

После успешной сборки запустите исполняемый файл `cnn_suite`, который находится в каталоге `build`.

```bash
./build/cnn_suite
```

## Использование

После запуска вам будет предложено меню:

```
--- CNN Suite Main Menu ---
1. Train MNIST Model
2. Test MNIST Model
3. Train Snake Agent
4. Visualize Snake Agent
5. Exit
Enter your choice:
```

- **1. Train MNIST Model**: Запускает обучение модели CNN на наборе данных MNIST. Вам будет предложено ввести количество эпох.
- **2. Test MNIST Model**: Загружает обученную модель `mnist_cnn_model.bin` и оценивает ее точность на тестовом наборе данных.
- **3. Train Snake Agent**: Запускает обучение DQN-агента для игры в "Змейку". Вам будет предложено ввести время обучения в минутах. Обученная модель сохраняется в `snake-dqn-final.bin`.
- **4. Visualize Snake Agent**: Загружает обученную модель `snake-dqn-final.bin` и отображает игру змейки в терминале.
- **5. Exit**: Выход из приложения.
